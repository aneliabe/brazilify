<% avg = w.average_rating.to_f %>

<div class="result-card glass-card p-3 h-100 d-flex flex-column hover-lift">
  <!-- header -->
  <div class="d-flex gap-3 align-items-center">
    <img src="<%= w.user.avatar.presence || 'https://placehold.co/64x64' %>"
         alt=""
         class="rounded-circle"
         style="width:64px;height:64px;object-fit:cover;border:1px solid var(--stroke);">

    <div class="flex-grow-1 min-w-0">
      <h4 class="h6 m-0 text-truncate"><%= w.user.full_name %></h4>

      <!-- stars + rating + reviews -->
      <div class="d-flex align-items-center gap-2 mt-1 flex-wrap">
        <span class="stars text-warning">
          <% 5.times do |i| %>
            <i class="fa-<%= i < avg.round ? 'solid' : 'regular' %> fa-star"></i>
          <% end %>
        </span>
        <span class="rating-pill"><%= number_with_precision(avg, precision: 1) %></span>
        <small class="text-muted">· <%= pluralize(w.reviews.size, "avaliação", "avaliações") %></small>
      </div>

      <!-- location -->
      <small class="text-muted d-inline-flex align-items-center gap-1 mt-1">
        <i class="fa-solid fa-location-dot"></i>
        <%= [w.user.city, w.user.country].compact.join(", ") %>
      </small>
    </div>
  </div>

  <!-- description -->
  <p class="text-muted mt-2 mb-0 clamp-2">
    <%= (w.description.presence || "Profissional qualificado e bem avaliado.").truncate(160) %>
  </p>

  <!-- services -->
  <% if w.services.any? %>
    <div class="chips mt-2">
      <% w.services.limit(3).each_with_index do |svc, i| %>
        <span class="chip tone-<%= (i % 4) + 1 %>">
          <i class="fa-solid fa-briefcase"></i> <%= svc.name %>
        </span>
      <% end %>
    </div>
  <% end %>

  <!-- CTA -->
  <div class="mt-auto pt-2 d-flex justify-content-end">
    <%= link_to "Ver perfil", worker_path(w), class: "btn-line btn-chat" %>
  </div>
</div>
