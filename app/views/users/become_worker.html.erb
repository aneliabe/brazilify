<%= simple_form_for @worker_profile, url: become_worker_user_path(@user), method: :post, data: { controller: "worker-form" } do |f| %>

  <%= f.input :cpf, label: "CPF", input_html: { class: "form-control" } %>
  <%= f.input :description, as: :text, label: "Descrição", input_html: { class: "form-control", rows: 3 } %>

  <!-- Container where service rows will be added -->
  <div id="worker-services" data-worker-form-target="servicesContainer">
    <%= f.simple_fields_for :worker_services do |ws| %>
      <%= render "worker_service_fields", f: ws, categories: @categories, service_types: @service_types %>
    <% end %>
  </div>

  <!-- Hidden template for new service rows -->
  <template id="worker-service-template">
    <%= f.simple_fields_for :worker_services, WorkerService.new, child_index: "NEW_RECORD" do |ws| %>
      <%= render "worker_service_fields", f: ws, categories: @categories, service_types: @service_types %>
    <% end %>
  </template>

  <div class="mt-2">
    <%= link_to "Adicionar serviço", "#", class: "btn btn-outline-secondary", data: { action: "click->worker-form#addServiceRow" } %>
  </div>

<BR>
    <div class="col-12">
    <div class="border rounded p-3 p-md-4">
      <h2 class="h6 text-muted mb-3">Adicione fotos dos seus serviços</h2>
      <%= f.file_field :place_photos, multiple: true, accept: "image/*",
            direct_upload: true, class: "form-control" %>
      <div class="form-text">Selecione várias imagens (JPG/PNG/WebP). Até ~10MB por foto.</div>
    </div>
  </div>

  <div class="mt-3">
    <%= f.submit @user.worker? ? "Atualizar informações" : "Ativar perfil de prestador", class: "btn btn-primary" %>
  </div>

  <div id="worker-services" data-worker-form-target="servicesContainer">
    <%= f.simple_fields_for :worker_services do |ws| %>
      <%= render "worker_service_fields", f: ws, categories: @categories, service_types: @service_types %>
    <% end %>
  </div>

  <!-- Hidden template for new service rows -->
  <template id="worker-service-template">
    <%= f.simple_fields_for :worker_services, WorkerService.new, child_index: "NEW_RECORD" do |ws| %>
      <%= render "worker_service_fields", f: ws, categories: @categories, service_types: @service_types %>
    <% end %>
  </template>

<% end %>
